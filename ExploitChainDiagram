┌─────────────────────────────────────────────────────────────┐
│                         1. User Actions                     │
├─────────────────────────────────────────────────────────────┤
│ • Register → Login                                          │
│ • Server sets session cookie                                |
└─────────────────────────────────────────────────────────────┘
                   │
                   ▼
┌─────────────────────────────────────────────────────────────┐
│                    2. SQL Injection                         │
├─────────────────────────────────────────────────────────────┤
│ • Admin Panel Authentication Bypass                         │
└─────────────────────────────────────────────────────────────┘
                   │
                   ▼
┌─────────────────────────────────────────────────────────────┐
│              3. Admin Panel → Hidden Hints                  │
├─────────────────────────────────────────────────────────────┤
│ Dashboard note:                                             │
│  “Helper port can recover my credentials. Only localhost.”  │
│                                                             │
│ Hidden: /admin/robots.txt (403 if not admin)                │
│ Contains:                                                   │
│     myrecoverydatakey                                       │
│     Secret Key: /secret.txt                                 │
└─────────────────────────────────────────────────────────────┘
                   │
                   ▼
┌─────────────────────────────────────────────────────────────┐
│                     4. SSRF via JS Compiler                 │
├─────────────────────────────────────────────────────────────┤
│ • JS compiler → fetch() SSRF                                │
│ • Send UDP packet to 127.0.0.1:1337                         │
│ • Payload: myrecoverydatakey                                │
│ • Server replies with XOR’ed credential                     │
└─────────────────────────────────────────────────────────────┘
                   │
                   ▼
┌─────────────────────────────────────────────────────────────┐
│                    5. Credential Recovery                   │
├─────────────────────────────────────────────────────────────┤
│ • Retrieve /secret.txt (FTP or HTTP protected area)         │
│ • XOR(decrypted, secret_key) → ftp_password                 │
└─────────────────────────────────────────────────────────────┘
                   │
                   ▼
┌─────────────────────────────────────────────────────────────┐
│                         6. FTP Access                       │
├─────────────────────────────────────────────────────────────┤
│ • Login with recovered creds                                │
│ • Find: identity-check (binary)                             │
│ • `strings` reveals SSH user/pass                           │
└─────────────────────────────────────────────────────────────┘
                   │
                   ▼
┌─────────────────────────────────────────────────────────────┐
│                       7. SSH Login                          │
├─────────────────────────────────────────────────────────────┤
│ • SSH into machine                                          │
│ • Grab user flag                                            │
└─────────────────────────────────────────────────────────────┘
                   │
                   ▼
┌─────────────────────────────────────────────────────────────┐
│                 8. Privilege Escalation (root)              │
├─────────────────────────────────────────────────────────────┤
│ • SUID binary: system-analyze                               │
│ • Binary loads writable .so file                            │
│ • Shared library hijack → root shell                        │
│ • Capture root flag                                         │
└─────────────────────────────────────────────────────────────┘
